import { Debug } from './debug.js'; import { TaskManager } from './taskmanager.js'; import { MemoryManager } from './memorymanager.js'; import { initOriginal } from './modules/original.js'; import { initHeatmap } from './modules/heatmap.js'; import { initContour } from './modules/contour.js'; import { initTopView } from './modules/topview.js'; import { initSimulation } from './modules/simulation.js'; window.addEventListener('DOMContentLoaded', ()=>{ Debug.init?.(); initOriginal(); initHeatmap(); initContour(); initTopView(); initSimulation(); const tabs=document.querySelectorAll('.tabs button'); tabs.forEach(btn=>btn.addEventListener('click', ()=>{ tabs.forEach(b=>b.classList.remove('active')); btn.classList.add('active'); const t=btn.dataset.tab; document.querySelectorAll('.tab').forEach(s=>s.classList.remove('active')); const sel=document.getElementById(t); if(sel) sel.classList.add('active'); if(t==='heatmap' && window.CncAi && window.CncAi.regenerateHeatmap) window.CncAi.regenerateHeatmap(); if(t==='topview' && window.CncAi && window.CncAi.renderTopView) window.CncAi.renderTopView(); })); document.getElementById('debug-toggle').addEventListener('click', ()=>{ if(Debug.el && Debug.el.style.display!=='none') Debug.hide(); else Debug.show(); }); window.addEventListener('beforeunload', ()=>{ TaskManager.clear(); MemoryManager.releaseCanvas(document.getElementById('image-canvas')); MemoryManager.releaseCanvas(document.getElementById('heatmap-canvas')); }); });